# ============================================================
# 基础系统配置
# ============================================================
CONFIG_MAIN_STACK_SIZE=2048
CONFIG_HEAP_MEM_POOL_SIZE=8192
CONFIG_PRINTK=y
CONFIG_STDOUT_CONSOLE=y
CONFIG_CBPRINTF_FP_SUPPORT=y

# ============================================================
# 蓝牙（BLE）配置
# ============================================================
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_BROADCASTER=y
CONFIG_BT_DEVICE_NAME="MyFitnessPod"
CONFIG_BT_GATT_CLIENT=y

# ============================================================
# 内核与线程管理
# ============================================================
CONFIG_MULTITHREADING=y
CONFIG_NUM_COOP_PRIORITIES=16
CONFIG_NUM_PREEMPT_PRIORITIES=16
CONFIG_POLL=y
CONFIG_TIMESLICING=y

# ============================================================
# 系统工作队列
# ============================================================
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048

# ============================================================
# 外设与传感器框架
# ============================================================
CONFIG_I2C=y
CONFIG_SPI=y
CONFIG_SENSOR=y

# ============================================================
# LSM6DSL 驱动支持
# ============================================================
CONFIG_LSM6DSL=y
CONFIG_LSM6DSL_TRIGGER_GLOBAL_THREAD=y
# CONFIG_LSM6DSL_TRIGGER_OWN_THREAD=y  # 二选一（默认 global）

# ============================================================
# 系统时钟（通常默认开启）
# ============================================================
CONFIG_SYS_CLOCK_EXISTS=y

# ============================================================
# GPIO（用于 LED 闪烁）
# ============================================================
CONFIG_GPIO=y

# === 1. 允许大 MTU (关键) ===
# 告诉协议栈我们想发大包，不要拆包
CONFIG_BT_L2CAP_TX_MTU=247
CONFIG_BT_CTLR_DATA_LENGTH_MAX=251
CONFIG_BT_BUF_ACL_TX_SIZE=251
CONFIG_BT_BUF_ACL_RX_SIZE=251
CONFIG_BT_L2CAP_DYNAMIC_CHANNEL=y

# === 3. 增加缓冲区数量 (解决 -12 错误的核心) ===
# 发送缓冲区 (TX) 设为 10
CONFIG_BT_BUF_ACL_TX_COUNT=80
CONFIG_BT_L2CAP_TX_BUF_COUNT=80

# === 4. 修复编译报错的关键配置 ===
# 接收缓冲区 (RX) 必须大于 TX (建议 TX + 6)
CONFIG_BT_BUF_EVT_RX_COUNT=86

CONFIG_BT_CONN_TX_MAX=80

# === 3. 启用数据长度扩展 (DLE) ===
# 允许在空中一次传输更多字节，提高吞吐量
CONFIG_BT_DATA_LEN_UPDATE=y
CONFIG_BT_USER_DATA_LEN_UPDATE=y
